# SPDX-License-Identifier: MPL-2.0

# Copyright Â© 2018-2026 Firas Khana

# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.

prepare() {
  cd "$tmp"/$nom/$nom-$nom-$ver
}

configure() {
  glaucus-muon \
    -Dapparmor=disabled \
    -Dchecks=false \
    -Ddbus_user=$nom \
    -Ddoxygen_docs=disabled \
    -Dducktype_docs=disabled \
    -Depoll=enabled \
    -Dinotify=enabled \
    -Dkqueue=disabled \
    -Dlaunchd=disabled \
    -Dlibaudit=disabled \
    -Dmodular_tests=disabled \
    -Dqt_help=disabled \
    -Drelocation=disabled \
    -Druntime_dir=/run \
    -Dselinux=disabled \
    -Dsession_socket_dir=/tmp \
    -Dsystem_pid_file=/run/$nom/pid \
    -Dsystem_socket=/run/$nom/system_bus_socket \
    -Dsystemd=disabled \
    -Dx11_autolaunch=disabled \
    -Dxml_docs=disabled \
    build
}

build() {
  samu \
    -C build
}

package() {
  DESTDIR="$dir" \
  muon \
    -C build \
    install/strip
}
